# 3. 系统状态与管理

## 1. 进程状态

### 1. ps指令——报告系统当前进程快照

- 语法：ps [选项]

- 功能介绍：ps指令**用于报告当前系统的进程状态**

- 常用选项

  - -e 参数指定显示所有运行在系统上的进程
  - -f  参数则扩展输出
  - -a 显示跟任意终端关联的所有进程
  - -u 采⽤基于用户的格式显示
  - -x 显示所有的进程，甚⾄包括未分配任何终端的进程

- 例子

  - ps -ef

    ```
    [root@boss ~]# ps -ef
    UID PID PPID C STIME TTY TIME CMD
    root 1 0 0 6⽉月21 ? 00:26:10 /usr/lib/systemd/systemd
    root 2 0 0 6⽉月21 ? 00:00:00 [kthreadd]
    root 3 2 0 6⽉月21 ? 00:00:58 [ksoftirqd/0]
    root 5 2 0 6⽉月21 ? 00:00:00 [kworker/0:0H]
    root 7 2 0 6⽉月21 ? 00:00:21 [migration/0]
    root 8 2 0 6⽉月21 ? 00:00:00 [rcu_bh]
    root 11 2 0 6⽉月21 ? 00:00:36 [watchdog/0]
    --------------------------------------------
    每列详解：
    UID：启动这些进程的用户
    PID：进程的进程ID
    PPID: 父进程的进程号(如果该进程是由另一个进程启动的)。
    C: 进程生命周期中的CPU利用率。
    STIME: 进程启动时的系统时间。
    TTY: 进程启动时的终端设备。
    TIME: 程序累计占⽤用 CPU 的时间
    CMD: 进程运行的命令
    ```

  - ps aux

    ```
    [root@boss ~]# ps aux
    USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
    root 1 0.0 0.0 948 4000 ? Ss 6⽉月21 26:10
    /usr/lib/systemd/systemd
    root 2 0.0 0.0 0 0 ? S 6⽉月21 0:00 [kthreadd]
    root 3 0.0 0.0 0 0 ? S 6⽉月21 0:58 [ksoftirqd/0]
    root 5 0.0 0.0 0 0 ? S< 6⽉月21 0:00 [kworker/0:0H]
    root 7 0.0 0.0 0 0 ? S 6⽉月21 0:21 [migration/0]
    root 8 0.0 0.0 0 0 ? S 6⽉月21 0:00 [rcu_bh]
    root 9 0.0 0.0 0 0 ? S 6⽉月21 66:51 [rcu_sched]
    --------------------------------------------
    每列信息：
    USER : 执行这个进程的用户
    PID : 进程 ID
    %CPU : 当前进程的 CPU 占用
    %MEM : 当前进程的 内存 占用
    VSZ : 进程占用的虚拟内存大小，以千字节(KB)为单位。
    RSS : 进程占用的物理内存大小
    TTY : 进程启动时的终端设备。
    STAT : 进程状态
    START : 进程启动时刻
    TIME : 程序累计占用 CPU 的时间
    COMMAND : 启动进程的命令
    --------------------------------------------
    关于STAT：
    代表当前进程状态的双字符状态码。
    第⼀个字符表明进程状态:
    		O : 代表正在运行
    		S : 代表在休眠
    		R : 代表可运行，正等待 CPU
    		Z : 代表僵化，进程已结束但父进程已不存在
    		T : 代表停止
    第二个参数进一步说明进程的状态细节:
    		< : 该进程运行在高优先级上。
    		N : 该进程运行在低优先级上。
    		L : 该进程有页面锁定在内存中。
    		s : 该进程是控制进程。
    		l : 该进程是多线程的。
    		+ : 该进程运行在前台。
    ```

### 2. top指令——实时报告系统整体性能情况

- 语法：top [选项]

- 功能介绍：top指令**可以实时动态的查看系统的整体运行情况，是一个综合了多方信息的监控系统性能和运行信息的实用功能**

- 常用选项

  - -b   以批处理模式操作
  - -d   屏幕刷新间隔时间

- 例子

  ![](G:\千峰教育\笔记\Typora\Linux\img\1.png)

  ```
  头信息逐行详解:
  	1. 系统运行的整体状态: 开机时长，登陆用户数，系统负载
  		系统负载:  load average: 0.00, 0.02, 0.05
  		分别代表: 一分钟负载，五分钟负载，十五分钟负载
  		负载值越高代表服务器压力越大
  		负载值不要超过 CPU 的核心数。如果超过核心数意味着有很多进程在等待使用 CPU
  		与  uptime 命令的结果一样 (查看系统状态)
  	2. 任务情况: 任务总数，运行中的数量，休眠数量，停⽌止数量，僵尸进程数量
  	3. CPU 使用情况:
  		us: (user) 用户态占用
  		sy: (system) 内核态占用
  		id: (idle) 空闲的 CPU
  	4. 内存占用情况: 内存总量, 空闲内存, 使用的内存, 缓冲区占用的内存
  	5. 交换分区的占用
  		交换分区是一种将内存数据保存到硬盘的技术，一般在内存不足的时候使用
  进程区详情:
  	PID: 进程的ID。
  	USER: 进程属主的名字。
  	PR: 进程的优先级。
  	NI: 进程的谦让度值。
  	VIRT: 进程占用的虚拟内存总量。
  	RES: 进程占用的物理内存总量。
  	SHR: 进程和其他进程共享的内存总量。
  	S: 进程的状态 (与 ps 基本相同)。
  	%CPU: 进程使用的CPU时间比例。
  	%MEM: 进程使用的内存占可用内存的比例。
  	TIME+: 自进程启动到目前为止的CPU时间总量。
  	COMMAND: 进程所对应的命令行名称，也就是启动的程序名。
  小技巧:
  	进程太多时，可以通过 -p 参数指定需要查看的进程ID，让进程信息更精简：
  	top -p PID1,PID2,PID3,...
  ```

### 3. htop命令

​	如果感觉 top 还不不够直观，可以使⽤用  htop
​	htop 不不是系统默认的命令，需要额外安装

- 安装： sudo apt install htop

- 详情

  ![](G:\千峰教育\笔记\Typora\Linux\img\2.png)



## 2. 进程的管理

### 1. kill指令——杀死进程

- 语法：kill [选项] [参数]
- 功能介绍：kill指令**用于管理进程和作业**，通过向进程和作业发送信号以实现相应的管理功能
- 常用选项
  - -1（HUP）平滑重启
  - -9（KILL）强制杀死进程
  - -15（TERM）正常终止进程（kill的默认信号）
  - -l    列出系统支持的信号
  - -s   指定向进程发送的信号

### 2. pkill指令——按名称杀死进程

- 语法：pkill [选项] [参数]
- 功能介绍：pkill指令**可以按照进程名称杀死进程**
- 常用选项
  - -o		仅向找到的最小(起始)进程号发送信号
  - -g        指定进程组
  - -t         指定开启进程的终端
  - -P        指定父进程号

### 3.killall指令——按照名称杀死进程

- 语法：killall [选项] [参数]
- 功能介绍：killall指令**使用进程的名称来杀死进程，使用此指令可以杀死一组同名进程**
- 常用选项
  - -e		对长名称进行精确匹配
  - -p       杀死进程所属的进程组
  - -r        使用正则表达式匹配要杀死的进名称
  - -u       杀死指定用户的进程

## 3. 其他状态

### 1.内存状态

- ### free指令——显示内存的使用情况

  - 语法：free [选项]

  - 功能介绍：free指令**可以显示当前系统未使用的和已使用的内存数目，还可以显示被内核使用的内存缓冲区**

  - 常用选项

    - -b	以字节为单位显示内存使用情况
    - -k    以千字节为单位显示内存使用情况，默认选项
    - -m  以兆字节为单位显示内存使用情况

  - 例子

    ![](G:\千峰教育\笔记\Typora\Linux\img\3.png)

### 2. 硬盘

- ### 1. iostat指令——报告CPU状态和设备及分区的I/O状态

  - 语法：iostat [选项] [参数]
  - 功能介绍：iostat指令**被用于监视系统输入输出设备和CPU的使用情况**
  - 常用选项
    - -c		仅显示CPU使用情况
    - -d       仅显示设备利用率
    - -t        显示每个报告产生时的时间
  - 例子   iostat : 查看硬盘写⼊入和读取的状态

- ### 2. df指令——报告磁盘空间使用情况

  - 语法：df [选项] [参数]
  - 功能介绍：df指令**用于显示磁盘分区上可用的磁盘空间**。默认的显示单位为KB
  - 常用选项
    - -l	仅列出本地文件系统的磁盘空间使用情况
    - -h   以容易阅读的方式显示磁盘空间使用情况
    - -B   指定显示时的块大小
    - -k   指定块大小为1KB
  - 例子    df -lh : 查看硬盘分区，及每个分区的剩余空间

- ### 3. du指令

  - du -hs ./ : 查看当前目录占用的硬盘大小

### 3. 网络状态

- ### 1. ifconfig指令——配置网络接口

  - 语法：ifconfig [参数]

  - 功能介绍：ifconfig指令**被用于配置和显示Linux内核中网络接口的网络参数**。指令执行后立即生效

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\4.png)

  - 例子  ifconfig 查看网卡状态, 常用来检查自身 IP 地址

- ### 2. netstat指令——显示网络状态

  - 语法：netstat [选项]

  - 功能介绍：nestat指令**用来打印Linux中网络子系统的状态信息**。netstat指令的功能包括打印网络连接状态、打印路由表内容、打印网络接口状态、打印伪装的连接和打印多播成员等

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\5.png)

    ![](G:\千峰教育\笔记\Typora\Linux\img\6.png)

- ### 3. ping指令——测试主机之间网络连通性

  - 语法：ping [选项] [参数]

  - 功能介绍：ping指令**用来测试主机之间网络的连通性**，它使用Internet控制消息协议。ping指令发出“ICMP Request”报文到目的主机。目的主机收到此报文后给出“ICMP Response”回应信息。如果发送端主机没有收到应答信息，则表明与目的主机的网络出现故障

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\7.png)

- ### 4. lsof指令——显示所有已打开文件列表

  - 语法：lsof [选项]
  - 功能介绍：lsof指令**用于显示Linux系统当前已经打开的所有文件列表**。
  - 例子
    - lsof -i :[PORT] 查看占用端口的程序
    - lsof -i tcp 查看所有 TCP 连接
    - lsof -u abc 查看用户 abc 打开的所有文件
    - lsof -p 123 查看 pid 为 123 的进程打开的所有文件

- ### 5.traceroute指令——追踪报文到达目的主机的路由

  - 语法：traceroute [选项] [参数]

  - 功能介绍：traceroute指令**用于追踪数据包在网络上的传输时的全部途径**，它默认发送的数据包大小是40字节

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\8.png)

- ### 6. DNS查询

  - #### 1. dig指令——DNS查询工具

    - 语法：dig [选项] [参数]

    - 功能介绍：dig指令**是常用的域名查询工具，可以用来测试域名系统工作是否正常**

    - 常用选项

      ![](G:\千峰教育\笔记\Typora\Linux\img\9.png)

  - #### 2. host指令——域名查询工具

    - 语法：host [选项] [参数]

    - 功能介绍：host指令**是常用得分域名查询工具，可以用来测试域名系统工作是否正常**

    - 常用选项

      ![](G:\千峰教育\笔记\Typora\Linux\img\11.png)

      ![](G:\千峰教育\笔记\Typora\Linux\img\12.png)

  - #### 3. nslookup指令——域名查询工具

    - 语法：nslookup [选项] [参数]

    - 功能介绍：nslookup指令**是常用域名查询工具**。nslookup支持交互查询方式。在交互式查询方式中支持如下的内部命令

    - 常用选项

      ![](G:\千峰教育\笔记\Typora\Linux\img\10.png)

### 4. 时间和日期

- ### 1. date指令——显示与设置系统日期时间

  - 语法：date [选项] [参数]

  - 功能介绍：date指令**用于显示当前系统的日期时间**。如果使用“-s”选项则可以设置当前的系统日期时间。

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\13.png)

  - 例子 date  +%Y-%m-%d   #2019-09-02

- ### 2. cal指令——显示日历

  - 语法：cal [选项] [参数]

  - 功能介绍：cal指令**用于显示当前日历，或者指定日期的日历。**

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\14.png)

### 5. 下载

- ### 1. curl指令

  - curl 执行 HTTP 访问，也可用来下载

- ### 2.  wget指令——从指定URL地址下载文件

  - 语法：wget [选项] [参数]

  - 功能介绍：wget指令**用来从指定的URL下载文件**。wget指令支持的协议包括HTTP协议、HTTPS协议和FTP协议。wget指令以非交互式的方式运行，可以使用wget指令完成对网站的镜像。

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\Linux\img\15.png)

    ![](G:\千峰教育\笔记\Typora\Linux\img\16.png)

- ### 3. scp指令——安全远程文件复制

  - 语法：scp [选项] [参数]

  - 功能介绍：**scp指令以加密的方式在本地主机和远程主机（或者两台远程主机）之间复制文件。**

  - 常用选项

    ![](G:\千峰教育\笔记\Typora\3.Linux\img\17.png)



